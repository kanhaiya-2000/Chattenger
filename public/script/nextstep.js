k=null,window.colors=localStorage.getItem("colors")||"#3F3F3F";let zct,interval=setTimeout(function(){$("#controls").fadeOut("slow")},2e3),interval2=setTimeout(function(){$("#controls2").fadeOut("slow")},2e3);function removeclip(){setTimeout(function(){$("textarea").remove()},1e3)}function showCurrent(e){Renderconfirm("-----------------------------------<br><span title='click to get a special information' style='padding:7px;cursor:pointer;background:#24677d;text-decoration:underline' onclick='$(this).next().show();$(this).remove()'>click here...</span><span style='color:red;display:none'>Call may not work if you use VPN.<br>Make sure that non-proxied UDP connection is allowed by your browser</span><br>-----------------------------------<br><span style='font-size:0.7em;font-family:none'>"+$(e).attr("title").split("\n").join("<br>")+"</span><br>-----------------------------------<br>Group created by <span style='color:yellow'>"+userdata.admin+"</span><br>Group ID: <span style='color:yellow'>"+userdata.nativeRoom+"</span><br>Max-users for this group: <span style='color:yellow'>"+population+" <br>(except admin)</span><br><br>Currently people in this group are:<span style='color:yellow'><br>"+users.join(", ")+"</span><br><br><span style='color:#f00'>-X-X-X-X- Important -X-X-X-X</span><br>User may be disconnected if<br><br>1.Admin removes him/her <br><br>2.Server connection is lost<br><br>3.Your connection is poor<br><br>* Automatic reconnection will be tried if disconnection was due to server or poor net connection(or message once ,you will be reconnected)<br><br>* If the admin removes you,server will not reconnect you<br>* Sharing files require all participants to have fairly good connection",!0)}function handleSong(e){let t=0;for(window.s=e,$("#onlinemusic").html("");t!=e.length;)$("#onlinemusic").append('<div style="width:40px;height:40px;border-radius:50%;cursor:pointer;" onclick="play(window.s['+t+'])"><img src="'+e[t].album.cover_small+'" style="border-radius:50%;width:100%;height:100%"></div>'),t++;document.getElementById("stylingtools").scrollTo(0,280)}function scrollToid(e){document.getElementById(e.split("#")[1])&&(document.getElementById("message-container").scrollTop=$(e).offset().top+document.getElementById("message-container").scrollTop,$(e).css("animation","s 1.2s"),setTimeout(function(){$(e).css("animation","none")},1200))}function play(e){audmusic[currI].pause(),zct&&zct.pause(),(zct=new Audio(e.preview)).play()}function changechatColor(e){window.colors=e.value,localStorage.setItem("colors",e.value),$(".messages").each(function(){this.style.background.includes("transparent")||($(this).css("background",e.value),$(this).css("box-shadow","2px 4px 5px "+e.value))}),document.getElementById("1")&&(document.getElementById("1").value=e.value)}function getTouch(e){return e.touches||e.originalEvent.touches}function ignite(e){var t=null,o=null;window.colors&&!document.getElementById(e).style.background.includes("transparent")&&(document.getElementById(e).style.background=window.colors,document.getElementById(e).style.boxShadow="2px 4px 5px "+window.colors),$("#"+e).on("touchstart",function(o){t=getTouch(o)[0].clientX,initial=$("#"+e).css("left")}),$("#"+e).on("touchmove",function(n){if(o=getTouch(n)[0].clientX,Math.abs(o-t)>130){let a=$("#"+e).find(".messagemain").text(),i=document.getElementById(e).className.split(" ")[1].split("chatpiece")[0].split("qw").join(" ");a||(a="Media"),a.length>100&&(a=a.substr(0,100)+"..."),$("#replytext").text(a),$("#replytexthead").text(i).css("font-weight","bold"),$("#replytextparent").attr("class","#"+e),$("#replytomsg").css("left",$("#message").offset().left+"px").css("width",$("#message").width()+"px"),$("#replytomsg").css("display","flex"),$("#message").focus(),o=null,t=null,n.cancelable&&n.preventDefault()}})}function showtype(){localStorage.getItem("typingdisabled")||window.typesent||(window.typesent=!0,setTimeout(function(){window.typesent=!1},3e3),users.length>1&&socket.emit("istyping",{user:userdata.nativeUser,auth:userdata.auth,roomid:userdata.nativeRoom}))}function UploadFilteredImage(e){e.toBlob(function(e){e.name=generateid()+"_filtered_image",upload({files:[e]})})}function updatenoti(e){$("body").click(),"block"==document.getElementById("videocallingpage").style.display&&(document.getElementById("newmsg")&&0==Number($("#controls .notice-marker").text())&&$("#newmsg").remove(),0==Number($("#controls .notice-marker").text())&&$('<p class="info" id="newmsg" style="background:black;color:pink;">-----New messages-----</p>').insertBefore(".messages:last"),$("#controls .notice-marker").show(),$("#controls .notice-marker").text(Number($("#controls .notice-marker").text())+1)),"block"==document.getElementById("voicecallingpage").style.display&&(document.getElementById("newmsg")&&0==Number($("#controls2 .notice-marker").text())&&$("#newmsg").remove(),0==Number($("#controls2 .notice-marker").text())&&$('<p class="info" id="newmsg" style="background:black;color:pink;">-----New messages-----</p>').insertBefore(".messages:last"),$("#controls2 .notice-marker").show(),$("#controls2 .notice-marker").text(Number($("#controls2 .notice-marker").text())+1)),"block"==document.getElementById("chatroom").style.display&&"right"==document.getElementById(e).style.float&&$("#newmsg").remove()}function managevdo(e){document.getElementById(e).className.includes("large")?(document.getElementById(e).srcObject=window.stream,document.getElementsByClassName("large")[0].style.transform=$("#selfview").css("transform"),document.getElementById("selfview").id=e,document.getElementsByClassName("large")[0].id="selfview",document.getElementById("selfview").muted=!0,$("#"+e).parent().remove()):$("#"+e).parent().remove()}function userManual(){Renderconfirm('<div style="text-align:center"><div style="display:flex;"><img src="https://kkleap.github.io/assets/chattenger_icon.webp" width="80" height="80" style="margin:auto;"></div><span style="color:#ff0;line-height:1.4em">*Clear your browser cache in case you are not able to view updates<br><br>*You can now privately reply to a user in the room.Just include "@{USERNAME}," in your message, or click on the more option of other\'s message and select <kbd>Reply Privately</kbd><br><br>*You can also disable/enable typing indicator in setting<br><br>*Few games are now added.You can play them using your desktop or laptop.Soon watch party feature will be added<br><br>*Hover or hold a profile pic in a message for a while to view profile pic in bigger size<br><br>* Your chats,files and calls are end-to-end encrypted.Nothing is stored in our server.<br><br>* Your messages are compressed optimally before delivering to other users using <a target=\'blank\' href=\'https://www.sciencedirect.com/topics/computer-science/lossless-compression\'>lossless technique</a> to save your bandwidth.<br><br>* Bandwidth saver when turned on delivers acceptable video quality on even 60-80KBps in one-to-one call.Try bandwidth saver in video-call if you want to limit your bandwidth consumption to (3MB-5MB)/min in a video-call. <br><br>* Click on any image file to open that file in new tab.This is not for GIF and stickers</span><h3 style="text-align:center">General instruction</h3><span>-> To change your profile pic,click your profile image at the top left and select a photo from your device</span><br><br><span>-> To place a call with your room members,click ellipsis dot(3 V dot group) at the top right and select \'video call\'or \'voice call\'.You can also give your Feedback by selecting \'Report\'</span><br><br><span>-> For admin,click the ellipsis dot and select \'Manage\' where you will find option to remove room members from the room and change password for your group</span><br><br><span>-> To share your location,click pin shaped icon at the top.If possible,turn on GPS to share more accurate location</span><br><br><span>-> For sharing file,click the attachment icon just right of location sharing icon</span><br><br><span>-> click ellipsis dot and choose the setting option for restricting bandwidth usage in call,turning off messaging sound,changing wallpaper and music.</span><br><br><span>-> With each message,you have a small black dots,click it to get posssible actions you can perform with that piece of message</span><br><br><span>-> If you are using touch devices,you can swipe(either leftward or rightward) a piece of msg to reply to or refer that msg</span><br><br><span>-> To send a voice message or to edit a photo,click the plus icon on the bottom left and go to \'other\' tab and select microphone icon to give access for sending voice messages or select camera icon to edit a photo</span><br><br><span>-> Click heart icon at the bottom to send emogies,gif and stickers</span><br><br><div style="text-align:center"><span>For reporting a bug<br><a target="_blank" href="mailto:chattengerweb@gmail.com?subject=reporting%20bugs%20"><i class="fa fa-bug"></i> Click here <i class="fa fa-bug"></i></a></span></div><br><br></div>',!0)}function toggle(e){if("fa fa-expand"==e.className){e.className="fas fa-compress";var t=document.documentElement,o=t.requestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullscreen;if(void 0!==o&&o)o.call(t);else if(void 0!==window.ActiveXObject){var n=new ActiveXObject("WScript.Shell");null!=n&&n.SendKeys("{F11}")}}else e.className="fa fa-expand",document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}function setMediaBitrates(e,t){return setMediaBitrate(setMediaBitrate(e,"video",300),"audio",20)}function setMediaBitrate(e,t,o){for(var n=e.split("\n"),a=-1,i=0;i<n.length;i++)if(0===n[i].indexOf("m="+t)){a=i;break}if(-1===a)return e;for(a++;0===n[a].indexOf("i=")||0===n[a].indexOf("c=");)a++;if(0===n[a].indexOf("b"))return n[a]="b=AS:"+o+"\nb=TIAS:"+1e3*o,n.join("\n");console.log("Adding new b line before line",a);var s=n.slice(0,a);return s.push("b=AS:"+o+"\nb=TIAS:"+1e3*o),(s=s.concat(n.slice(a,n.length))).join("\n")}window.onscroll=function(){e&&clearTimeout(e);var e=setTimeout(function(){$("#controls").fadeIn("fast"),"none"==document.getElementById("chatroom").style.display?$("#datasaver-badge").fadeIn("fast"):$("#datasaver-badge").hide(),clearTimeout(interval),interval=setTimeout(function(){$("#controls").fadeOut("slow")},2e3),$("#controls2").fadeIn("fast"),clearTimeout(interval2),interval2=setTimeout(function(){$("#controls2").fadeOut("slow")},2e3)},200)},$(document).ready(function(){window.location.toString().includes("?")&&atob(window.location.toString().split("?")[1]).includes("&key=")&&atob(window.location.toString().split("?")[1]).includes("roomid=")?($("#login").hide(),setTimeout(function(){var e;(e=localStorage.getItem("loginusername")?localStorage.getItem("loginusername"):prompt("Enter your name"))||(e="G"+Math.floor(1e5*Math.random())),$("#login").show(),$("#name").val(e),$("#pwd").val(atob(window.location.toString().split("?")[1]).split("&key=")[1]),$("#roomid").val(atob(window.location.toString().split("?")[1]).split("roomid=")[1].split("&key=")[0]),setUsername()},2e3)):localStorage.getItem("loginusername")&&localStorage.getItem("loginpassword")&&localStorage.getItem("loginroomid")&&setTimeout(function(){$("#name").val(localStorage.getItem("loginusername")),$("#pwd").val(localStorage.getItem("loginpassword")),$("#roomid").val(localStorage.getItem("loginroomid")),Renderconfirm("<label for='profilechangeinput'><div id='userimg' title='@"+(localStorage.getItem("loginusername")||"user")+" profilepic,click to select another pic' class='avatar' style='cursor:pointer;width:50px;height:50px;margin:auto;margin-bottom:5px;background-image:url("+localStorage.getItem("profileinfo")+")'></div></label>hi "+localStorage.getItem("loginusername")+"!<br>join back your previous room? <br><br>Press <span style='background:green;padding:6px;color:black;font-weight:bold;border-radius:8px'>yes</span> for the same")},100)&&$("#error-container").hide()}),window.addEventListener("mousemove",function(e){k&&clearTimeout(k),k=setTimeout(function(){clearTimeout(interval),$("#controls").fadeIn("fast"),"none"==document.getElementById("chatroom").style.display?$("#datasaver-badge").fadeIn("fast"):$("#datasaver-badge").hide(),interval=setTimeout(function(){$("#controls").fadeOut("slow"),$("#datasaver-badge").fadeOut("slow")},2e3),clearTimeout(interval2),$("#controls2").fadeIn("fast"),interval2=setTimeout(function(){$("#controls2").fadeOut("slow"),$("#datasaver-badge").fadeOut("slow")},2e3)},200)},{passive:!0}),window.addEventListener("touchstart",function(){k&&clearTimeout(k),k=setTimeout(function(){clearTimeout(interval),$("#controls").fadeIn("fast"),"none"==document.getElementById("chatroom").style.display?$("#datasaver-badge").fadeIn("fast"):$("#datasaver-badge").hide(),interval=setTimeout(function(){$("#controls").fadeOut("slow"),$("#datasaver-badge").fadeOut("slow")},2e3),clearTimeout(interval2),$("#controls2").fadeIn("fast"),interval2=setTimeout(function(){$("#controls2").fadeOut("slow"),$("#datasaver-badge").fadeOut("slow")},2e3)},200)},{passive:!0}),window.addEventListener("click",function(){"message"==document.activeElement.id&&($("#moreoptions").hide(),$("#adminsection").hide()),k&&clearTimeout(k),k=setTimeout(function(){clearTimeout(interval),$("#controls").fadeIn("fast"),"none"==document.getElementById("chatroom").style.display?$("#datasaver-badge").fadeIn("fast"):$("#datasaver-badge").hide(),interval=setTimeout(function(){$("#controls").fadeOut("slow"),$("#datasaver-badge").fadeOut("slow")},2e3),clearTimeout(interval2),$("#controls2").fadeIn("fast"),interval2=setTimeout(function(){$("#controls2").fadeOut("slow"),$("#datasaver-badge").fadeOut("slow")},2e3)},200)},{passive:!0}),$("#controls").on("mouseover",function(){clearTimeout(interval),$("#controls").fadeIn("fast"),"none"==document.getElementById("chatroom").style.display?$("#datasaver-badge").fadeIn("fast"):$("#datasaver-badge").hide()}),$("#controls").on("mouseleave",function(){interval&&clearTimeout(interval),interval=setTimeout(function(){$("#controls").fadeOut("slow")},2e3)}),$("#controls2").on("mouseover",function(){clearTimeout(interval2),$("#controls2").fadeIn("fast"),"none"==document.getElementById("chatroom").style.display?$("#datasaver-badge").fadeIn("fast"):$("#datasaver-badge").hide()}),$("#controls2").on("mouseleave",function(){interval2&&clearTimeout(interval2),interval2=setTimeout(function(){$("#controls").fadeOut("slow")},2e3)}),socket.on("changeprofilepic",function(e){let t=document.getElementsByClassName(e.user.split(" ").join("qw")+"profilepic");for(x of t)x.style.backgroundImage="url("+e.profile+")",x.onclick=function(){showProfileModal(e.profile)},x.onmouseover=function(){showProfileModal(e.profile)};document.getElementById(e.user.split(" ").join("qw")+"indicator")&&$("#"+e.user.split(" ").join("qw")+"indicator").parent().parent().css("background-image","url("+e.profile+")")}),socket.on("videovoice",function(e){document.getElementById(e.user.split(" ").join("qw"))&&$("#"+e.user.split(" ").join("qw")).next().css("visibility",e.status)}),socket.on("reversecamera",function(e){document.getElementById(e.user.split(" ").join("qw"))&&(document.getElementById(e.user.split(" ").join("qw")).style.transform=e.style,e.screenshare?$("#adduser").hide():$("#adduser").show())}),(localStorage.getItem("updated_v1.1")||localStorage.getItem("updated_v1.2")||localStorage.getItem("updated"))&&(localStorage.removeItem("updated"),localStorage.removeItem("updated_v1.1"),localStorage.removeItem("updated_v1.2"),window.location.reload()),window.typesent=!1,socket.on("refreshit",function(){$(window).unbind("beforeunload"),document.body.onbeforeunload=null,window.location.reload()}),setTimeout(function(){if(!localStorage.getItem("updated_v1.28")){localStorage.setItem("updated_v1.28",!0),localStorage.setItem("textsize",window.textsize="1em"),localStorage.setItem("textcolor",window.textcolor="#f7f7ef"),localStorage.setItem("textfont",(window.textfont=DEFAULT_FONT)),localStorage.setItem("colors",window.colors="#2e3436"),localStorage.removeItem("updated_v1.27");let e=localStorage.getItem("profileinfo");"https://kkleap.github.io/assets/default.jpg"==e&&(e="https://kkleap.github.io/assets/chattenger_male.jpg"),"https://kkleap.github.io/assets/default_f.png"==e&&(e="https://kkleap.github.io/assets/chattenger_female.jpg"),localStorage.setItem("profileinfo",e)}document.getElementById("2").value=window.textcolor,document.getElementById("3").value=localStorage.getItem("textsize")?localStorage.getItem("textsize").split("em")[0]:"1",!localStorage.getItem("opacity")&&localStorage.setItem("opacity","0.84"),document.getElementById("opacityranger").value=localStorage.getItem("opacity")>=0.8&&localStorage.getItem("opacity")<1?localStorage.getItem("opacity"):"1",document.getElementById("1").value=window.colors,document.getElementById("4").value=window.textfont},5e3),"mediaDevices"in navigator&&"enumerateDevices"in navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices().then(function(e){const t=e.filter(e=>"videoinput"===e.kind);1==Object.keys(t).length&&$("#togglecamera").remove()}),filesocket.on("disconnect",function(){should_reconnect&&users&&(window.filesocketpingconnect=setInterval(function(){filesocket.connected?clearInterval(window.filesocketpingconnect):navigator.onLine&&filesocket.disconnected&&(filesocket.connect(),filesocket.emit("joinroom",{nativeRoom:userdata.nativeRoom,auth:userdata.auth,nativeUser:userdata.nativeUser}))},1500))});