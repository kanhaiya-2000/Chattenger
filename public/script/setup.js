$('#datasaver').click(function(){(this.checked)?(localStorage.setItem('datasaver','yes'),$('#datasaver-badge').css('background','#0f0').attr('title','datasaver is enabled')):(localStorage.setItem('datasaver','no'),$('#datasaver-badge').css('background','#f00').attr('title','datasaver is disabled'))});if(window.textcolor=localStorage.getItem("textcolor")||"#f7f7ef",window.textsize=localStorage.getItem("textsize")||"1em",window.textfont=localStorage.getItem("textfont")||"New Century Schoolbook, TeX Gyre Schola, serif",window.location.toString().includes("?")){try{atob(window.location.toString().split("?")[1])}catch(e){alert("Hmmmm!Your link appears to be broken!"),window.location.search=""}if(atob(window.location.toString().split("?")[1]).includes("&key=")&&atob(window.location.toString().split("?")[1]).includes("roomid=")){$("#login").hide()}else{window.history.replaceState({}, document.title, "/")}}function DeleteRoom(){confirm("Are u sure to delete?")&&socket.emit('Delroom',{user:userdata.nativeUser,auth:userdata.auth,roomid:userdata.nativeRoom})}function uploadToImgur(e){url="https://api.imgur.com/3/upload/";var t=new XMLHttpRequest;t.responseType="json",t.open("POST",url),t.setRequestHeader("Authorization","Client-ID 62daa59af836a43"),t.onload=function(){var e=t.response;e.success?(console.log(e),localStorage.setItem("profileinfo",e.data.link),document.getElementById("userimg").style.backgroundImage='url('+e.data.link+')',socket.emit("changeprofilepic",{user:userdata.nativeUser,roomid:userdata.nativeRoom,profile:e.data.link})):alert("Error in setting profilepic!")},t.send(e.files[0])}function stopsong(){incoming.pause(),disconnect.pause(),localStorage.setItem('isSilent',beeper.checked),ring.pause()}function messagemainstyle(e,t){switch(t){case"textcolor":$(".messagemain").css("color",e.value),window.textcolor=e.value,localStorage.setItem("textcolor",e.value);break;case"textfont":$(".messagemain").css("font-family",e.value),window.textfont=e.value,localStorage.setItem("textfont",e.value);break;case"textsize":$(".messagemain").css("font-size",e.value+"em"),window.textsize=e.value+"em",localStorage.setItem("textsize",e.value+"em");break;}}async function inviteParticipant(){localStorage.getItem("shareinstruction")||(Renderconfirm("Link will not work if the admin of this group has changed password after you joined this group unless you are the admin",!0),localStorage.setItem("shareinstruction",!0));let e={url:"https://chattenger.herokuapp.com/?"+btoa("roomid="+localStorage.getItem("loginroomid")+"&key="+localStorage.getItem("loginpassword")),title:"Chattenger:web app for text,video and voice chat",text:"hey there!Come and enjoy chatting on chattenger with me alongwith a lot more features!For utilising full features,open the link in chrome,firefox,opera or edge browser only.For ios mobile,use safari"};if($("#moreoptions").hide(),localStorage.getItem("loginroomid")&&localStorage.getItem("loginpassword")){let t=document.createElement("textarea");if(t.value=e.url,document.body.appendChild(t),t.select(),document.execCommand("copy"),t.remove(),document.getElementById("message-container").scrollTop=document.getElementById("message-container").scrollHeight,"share" in navigator)try{$("#message-container").append("<p class='info' style='color:green;background:black'>Link was copied to clipboard!<br>You can share link</p>"),await navigator.share(e)}catch(e){$("#message-container").append("<p class='info' style='color:red;background:black'>Error occured!<br>Link was copied to clipboard!You can share link</p>"),document.getElementById("message-container").scrollTop=document.getElementById("message-container").scrollHeight}else $("#message-container").append("<p class='info' style='color:green;background:black'>Link was copied to clipboard!<br>You can share link</p>"),document.getElementById("message-container").scrollTop=document.getElementById("message-container").scrollHeight}else $("#message-container").append("<p class='info' style='color:red;background:black'>It appears that you cleared cookies and site-data.<br>Error in sharing!</p>"),document.getElementById("message-container").scrollTop=document.getElementById("message-container").scrollHeight}function Renderconfirm(e,t=!1){$("#login").hide(),document.getElementById("rendering")&&$("#rendering").remove(),$("body").prepend('<div id="rendering" style="animation:sz 1.2s linear;position:fixed;padding-top:10px;top:150px;font-size:0.8em;none;border-radius:15px;z-index:1000000;width:300px;left:calc(50% - 150px);background:#3a3a3a;box-shadow:5px 5px 5px black;"><div style="overflow-y:auto;overflow-x:hidden;padding:10px;max-height:150px;background:#282c34;color:white;text-align:center">'+e+'</div><div style="display:flex;height:30px;padding-top:10px;padding-bottom:10px;justify-content:space-around"><button id="lb" style="background:green;cursor:pointer;transition:0.3s;border-radius:8px;font-weight:bold;width:80px">Yes</button><button id="rb" style="background:red;cursor:pointer;transition:0.6s;border-radius:8px;font-weight:bold;width:80px">No</button></div></div>'),$("#rendering").css("font-family",'"Vollkorn", serif'),$("#lb").on("click",function(){$(this).parent().parent().remove(),t||($("#login").show(),$("#name").val(localStorage.getItem("loginusername")),$("#pwd").val(localStorage.getItem("loginpassword")),$("#roomid").val(localStorage.getItem("loginroomid")),setUsername())}),$("#lb").on("mouseover",function(){$(this).css("background","yellow")}),$("#lb").on("mouseout",function(){$(this).css("background","green")}),$("#rb").on("mouseover",function(){$(this).css("background","yellow")}),$("#rb").on("mouseout",function(){$(this).css("background","red")}),$("#rb").on("click",function(){$(this).parent().parent().remove(),$("#login").show()}),t&&($("#rb").remove(),$("#lb").text("ok"))}$("body").css("overflow-y","scroll"),localStorage.getItem("profileinfo")||localStorage.setItem("profileinfo","https://kkleap.github.io/assets/default.jpg");
